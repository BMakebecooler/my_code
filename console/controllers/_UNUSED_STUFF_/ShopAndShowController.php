<?php/** * php ./yii export/shop-and-show/export-new-orders * php ./yii export/shop-and-show/test-export-new-users */namespace console\controllers\export;use common\models\user\User;use skeeks\cms\shop\models\ShopOrder;use yii\base\Exception;use yii\helpers\Console;/** * Class ShopAndShowController * * @package console\controllers */class ShopAndShowController extends \yii\console\Controller{    protected $agentStartTime;    protected $logger;    protected $shopAndShow;    public function beforeAction($action)    {        $this->stdout("\nBegin: ".$action->getUniqueId()."\n\n", Console::FG_YELLOW);        $this->agentStartTime = time();        return true;    }    public function afterAction($action, $result)    {        $this->stdout("\n\nElapsed: ".(time() - $this->agentStartTime)."sec.\n", Console::FG_YELLOW);        return parent::afterAction($action, $result);    }    public function actionListen(){        \Yii::$app->shopAndShow->listen();    }    /**     * Тест отправки пользователя в рэббит     */    public function actionTestExportNewUsers(){        $user = User::findByUsername('ivantest_testov');        $user->username = $user->username . mt_rand(0,100);        \Yii::$app->shopAndShow->sendCreateUserBitrix($user);    }    public function actionUpdateUser($id)    {        $user = User::findOne($id);        if ($user === null)            return false;        \Yii::$app->shopAndShow->sendUpdateUser($user);    }}