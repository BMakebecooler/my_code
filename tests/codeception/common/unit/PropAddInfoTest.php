<?php

namespace tests\codeception\common;

use common\components\queue\Factory;
use common\components\queue\HandlerInterface;

/**
 * Created by PhpStorm.
 * User: nikitaignatenkov
 * Date: 2019-03-26
 * Time: 16:56
 */
class PropAddInfoTest extends \Codeception\Test\Unit
{
    public function testHandlerCreate()
    {
        $json = '{"Info":{"Type":"PROP_ADD_INFO","Version":"2.0","Source":"KFSS","SourceDetail":"KSAS_DCC.OFFCNT.PROP_ADD_INFO_INSERT","Date":"2019-04-02T12:58:01+03:00"},"Data":{"OffcntGuid":"1750795CB6A34B82A56BE31C6D1E180C","Props":[{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Удобное хранение и переноска благодаря удобному размеру,","PropValue":"Удобное хранение и переноска благодаря удобному размеру,"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Полностью растворяется даже в холодной воде","PropValue":"Полностью растворяется даже в холодной воде"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Подходит для ручной и машинной стирки","PropValue":"Подходит для ручной и машинной стирки"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Подходит для любых тканей","PropValue":"Подходит для любых тканей"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"2в1 - Порошок и Кондиционер","PropValue":"2в1 - Порошок и Кондиционер"},{"PropTypeGuid":"72D67C218019C11AE0538201090AB50A","PropValueShort":"3 упаковки = 60 стирок.\nАроматы:\nГолубой - свежий аромат\nРозовый - цветочный аромат\n\nСостав: серебро, вода, глицерин, крахмал, оксид цинка, додецилбензолсульфонат, поливиниловый спирт, додецилсульфат натрия, бензил ацетат, диоксид кремния, лаурилсульфат натрия\n\nСпособ применения: положите в барабан стиральной машины или растворите в теплой воде для ручной стирки.\nРасход средства на 3 кг белья - половина листа. На 7 кг белья - 1 лист.\n\nПроизводство: Южная Корея\nВес: 50 г (10 листов)","PropValue":"3 упаковки = 60 стирок.\nАроматы:\nГолубой - свежий аромат\nРозовый - цветочный аромат\n\nСостав: серебро, вода, глицерин, крахмал, оксид цинка, додецилбензолсульфонат, поливиниловый спирт, додецилсульфат натрия, бензил ацетат, диоксид кремния, лаурилсульфат натрия\n\nСпособ применения: положите в барабан стиральной машины или растворите в теплой воде для ручной стирки.\nРасход средства на 3 кг белья - половина листа. На 7 кг белья - 1 лист.\n\nПроизводство: Южная Корея\nВес: 50 г (10 листов)"},{"PropTypeGuid":"72D67C21801CC11AE0538201090AB50A","PropValueShort":"Подходит для любых тканей, цветного и белого белья, в автоматическом и ручном режиме. Содержит кондиционер. Экопродукт без парабенов и фосфатов.\n\nЛистовой стиральный порошок Hanjang представляет собой пластины, на 90% состоящие из концентрированного моющего средства, которое эффективно очищает даже сложные загрязнения. Еще одна важная особенность Hanjang - система защиты, которая предотвращает деформацию ткани. Также листовой стиральный порошок создает антистатический эффект. На 100% растворяется даже в холодной воде. Одна пластина равна 65 г порошка или 70 мл геля для стирки. Позволяет экономить место в ванной комнате.  Средство биологически разлагаемо.","PropValue":"Подходит для любых тканей, цветного и белого белья, в автоматическом и ручном режиме. Содержит кондиционер. Экопродукт без парабенов и фосфатов.\n\nЛистовой стиральный порошок Hanjang представляет собой пластины, на 90% состоящие из концентрированного моющего средства, которое эффективно очищает даже сложные загрязнения. Еще одна важная особенность Hanjang - система защиты, которая предотвращает деформацию ткани. Также листовой стиральный порошок создает антистатический эффект. На 100% растворяется даже в холодной воде. Одна пластина равна 65 г порошка или 70 мл геля для стирки. Позволяет экономить место в ванной комнате.  Средство биологически разлагаемо."},{"PropTypeGuid":"72D67C218026C11AE0538201090AB50A","PropValueShort":"Голубой - свежий аромат\nРозовый - цветочный аромат","PropValue":"Голубой - свежий аромат\nРозовый - цветочный аромат"},{"PropTypeGuid":"72D67C218027C11AE0538201090AB50A","PropValueShort":null,"PropValue":null},{"PropTypeGuid":"72D67C21802FC11AE0538201090AB50A","PropValueShort":"4","PropValue":null},{"PropTypeGuid":"72D67C218025C11AE0538201090AB50A","PropValueShort":null,"PropValue":null},{"PropTypeGuid":"72D67C218023C11AE0538201090AB50A","PropValueShort":"N","PropValue":null},{"PropTypeGuid":"72D67C21801AC11AE0538201090AB50A","PropValueShort":"Порошок для стирки \"HANJANG\" листовой - 3 упаковки ","PropValue":"Порошок для стирки \"HANJANG\" листовой - 3 упаковки "},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Система защиты текстиля \n- Помогает предотвратить повреждение и деформацию одежды при помощи  специальной защитной пленки,  создаваемой полимерами, которые  растроряются при контакте с водой.\n","PropValue":"Система защиты текстиля \n- Помогает предотвратить повреждение и деформацию одежды при помощи  специальной защитной пленки,  создаваемой полимерами, которые  растроряются при контакте с водой.\n"}]}}';

        $handler = Factory::factory($json);

        $this->assertTrue($handler  instanceof  HandlerInterface);

    }

    public function testHandlerExecute()
    {
        $json = '{"Info":{"Type":"PROP_ADD_INFO","Version":"2.0","Source":"KFSS","SourceDetail":"KSAS_DCC.OFFCNT.PROP_ADD_INFO_INSERT","Date":"2019-04-02T12:58:01+03:00"},"Data":{"OffcntGuid":"1750795CB6A34B82A56BE31C6D1E180C","Props":[{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Удобное хранение и переноска благодаря удобному размеру,","PropValue":"Удобное хранение и переноска благодаря удобному размеру,"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Полностью растворяется даже в холодной воде","PropValue":"Полностью растворяется даже в холодной воде"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Подходит для ручной и машинной стирки","PropValue":"Подходит для ручной и машинной стирки"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Подходит для любых тканей","PropValue":"Подходит для любых тканей"},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"2в1 - Порошок и Кондиционер","PropValue":"2в1 - Порошок и Кондиционер"},{"PropTypeGuid":"72D67C218019C11AE0538201090AB50A","PropValueShort":"3 упаковки = 60 стирок.\nАроматы:\nГолубой - свежий аромат\nРозовый - цветочный аромат\n\nСостав: серебро, вода, глицерин, крахмал, оксид цинка, додецилбензолсульфонат, поливиниловый спирт, додецилсульфат натрия, бензил ацетат, диоксид кремния, лаурилсульфат натрия\n\nСпособ применения: положите в барабан стиральной машины или растворите в теплой воде для ручной стирки.\nРасход средства на 3 кг белья - половина листа. На 7 кг белья - 1 лист.\n\nПроизводство: Южная Корея\nВес: 50 г (10 листов)","PropValue":"3 упаковки = 60 стирок.\nАроматы:\nГолубой - свежий аромат\nРозовый - цветочный аромат\n\nСостав: серебро, вода, глицерин, крахмал, оксид цинка, додецилбензолсульфонат, поливиниловый спирт, додецилсульфат натрия, бензил ацетат, диоксид кремния, лаурилсульфат натрия\n\nСпособ применения: положите в барабан стиральной машины или растворите в теплой воде для ручной стирки.\nРасход средства на 3 кг белья - половина листа. На 7 кг белья - 1 лист.\n\nПроизводство: Южная Корея\nВес: 50 г (10 листов)"},{"PropTypeGuid":"72D67C21801CC11AE0538201090AB50A","PropValueShort":"Подходит для любых тканей, цветного и белого белья, в автоматическом и ручном режиме. Содержит кондиционер. Экопродукт без парабенов и фосфатов.\n\nЛистовой стиральный порошок Hanjang представляет собой пластины, на 90% состоящие из концентрированного моющего средства, которое эффективно очищает даже сложные загрязнения. Еще одна важная особенность Hanjang - система защиты, которая предотвращает деформацию ткани. Также листовой стиральный порошок создает антистатический эффект. На 100% растворяется даже в холодной воде. Одна пластина равна 65 г порошка или 70 мл геля для стирки. Позволяет экономить место в ванной комнате.  Средство биологически разлагаемо.","PropValue":"Подходит для любых тканей, цветного и белого белья, в автоматическом и ручном режиме. Содержит кондиционер. Экопродукт без парабенов и фосфатов.\n\nЛистовой стиральный порошок Hanjang представляет собой пластины, на 90% состоящие из концентрированного моющего средства, которое эффективно очищает даже сложные загрязнения. Еще одна важная особенность Hanjang - система защиты, которая предотвращает деформацию ткани. Также листовой стиральный порошок создает антистатический эффект. На 100% растворяется даже в холодной воде. Одна пластина равна 65 г порошка или 70 мл геля для стирки. Позволяет экономить место в ванной комнате.  Средство биологически разлагаемо."},{"PropTypeGuid":"72D67C218026C11AE0538201090AB50A","PropValueShort":"Голубой - свежий аромат\nРозовый - цветочный аромат","PropValue":"Голубой - свежий аромат\nРозовый - цветочный аромат"},{"PropTypeGuid":"72D67C218027C11AE0538201090AB50A","PropValueShort":null,"PropValue":null},{"PropTypeGuid":"72D67C21802FC11AE0538201090AB50A","PropValueShort":"4","PropValue":null},{"PropTypeGuid":"72D67C218025C11AE0538201090AB50A","PropValueShort":null,"PropValue":null},{"PropTypeGuid":"72D67C218023C11AE0538201090AB50A","PropValueShort":"N","PropValue":null},{"PropTypeGuid":"72D67C21801AC11AE0538201090AB50A","PropValueShort":"Порошок для стирки \"HANJANG\" листовой - 3 упаковки ","PropValue":"Порошок для стирки \"HANJANG\" листовой - 3 упаковки "},{"PropTypeGuid":"72D67C218022C11AE0538201090AB50A","PropValueShort":"Система защиты текстиля \n- Помогает предотвратить повреждение и деформацию одежды при помощи  специальной защитной пленки,  создаваемой полимерами, которые  растроряются при контакте с водой.\n","PropValue":"Система защиты текстиля \n- Помогает предотвратить повреждение и деформацию одежды при помощи  специальной защитной пленки,  создаваемой полимерами, которые  растроряются при контакте с водой.\n"}]}}';


        $handler = Factory::factory($json);

        $this->assertTrue($handler->execute());

    }
}